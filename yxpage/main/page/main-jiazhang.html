<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>应用导航</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="../../main/layui/css/layui.css" media="all" />
	<link rel="stylesheet" href="../css/font-awesome.min.css" media="all" />
</head>
<style>

    html,body{

        padding:10px;

        background-color: #eee;

        height: calc(100% - 20px);

        

    }

    body{

        padding:10px;

    }

    * ::selection {

    background: #316cc5;

    color: rgb(255, 255, 255)!important;

}

    .layui-container{

        background-color: transparent;

        border-radius: 20px;

        width: 100%;

        height:100%;

        color:#000;

    }

        #user-menus{

            

            padding: 20px;

            /* display: ; */

            display: grid;

            grid-gap: 10px;

            grid-template-columns: 1fr 1fr 1fr 1fr ;

        }

        .tenant-layout{

            display: flex;

            flex-direction: column;

            font-size: 13px;

            height: 120px;

            border: 1px solid #eee;

                border-radius: 10px;

                background-color: rgb(244, 246, 249);

        }

        .tenant-layout.active{

            border-color: #1e9fff;

        }

        .tenant-layout:hover{

            cursor:pointer; 

            border-color: #1e9fff;

        }

        .tenant-layout-tag{

            height: 25px;

            display: flex;

                flex-direction: column;

                /* justify-content: space-between; */

                width: max-content;

                align-items: normal;

                padding: 10px 0;

        }

        .tenant-layout-tag span{

            

            background-color: #1e9fff;

            color: #fff;

            line-height: 14px;

            padding: 5px 20px;

            height: 24px;

        }

        .avatar{

            width: 40px;

            height: 40px;

            padding: 10px;

            border-radius: 50%;

            /* border: 1px solid #eee; */

        }

        .tenant-layout-app{

            padding: 2px 10px 10px 10px;

            display: flex;

            height: 55px;

            align-items: center;

            flex-direction: row;

        }

        .tenant-layout-app div{

            display: flex;

            flex-direction: column;

        }

        .sub-name-text{

            font-size: 12px;

            color: #b3b3b3;

            border: 1px solid  #b3b3b3;

            border-radius: 2px;

            width: max-content;

            padding: 0 5px;

        }

        .name-text{

            font-size: 16px;color: #000;

            font-weight: bold;

        }

        .info-layout{

            padding:10px;

            background-color: rgba(255, 255, 255, 0.314);

            box-shadow: rgba(183, 215, 247, 0.2) 0px 8px 10px 0px;

            border-radius: 10px;

            min-height: 3rem;

        }

        .info-layout #sys-apps .active{

            border:1px solid #1e9fff;

            color:#1e9fff;

        }

        .info-layout .layout-title-text{

            color:#000;

        }

        .table th{

            padding: 4px 2px;

        }

        .table tr{

            border-bottom: 1px solid rgb(225, 229, 241);

        }

        .table td{

            padding: 4px 2px;

        }

        /* .tenant-layout{

            width: ;

        } */

    </style>
<body class="" style="background-image: url('../images/xxlj/bg.jpg');">

    <div class="layui-container" style="display: grid;grid-gap: 10px;grid-template-columns: 280px auto;height:44%;  ">

        <div class="home-page-left" style="width:280px;display: grid;grid-gap: 10px;">

            <div class="user-info info-layout" style="background-color: #ffffff;">

                <div class="layout-title-text" style="font-size: 1rem;line-height: 1.6rem;font-weight: bold;">我的信息</div>

                <div  style="display: flex;flex-direction: column; box-sizing: border-box; align-items:center;width: 100%;padding: 10px;height:calc(100% - 9.6rem)">

                    <div>

                        <img src="../images/user.png" alt="" srcset="" style="background-color: #1e9fff;height:60px;width: 60px;border-radius: 50%;">

                    </div>

                    <div style="font-size:1rem;text-align: center;padding:10px;">

                        <div id="user-name" style="font-size:1.1rem;font-weight: bold;">姓名：</div>

                        

                        <div id="user-no">----</div>

                    </div>

                </div>

                <div  style="display: flex;flex-direction: column;justify-content: space-around; height:8rem; box-sizing: border-box; align-items:center;width: 100%;padding: 10px;">

                    <button class="layui-btn layui-btn-primary layui-border-blue layui-btn-radius" style="width:80%;">

                    学校信息维护</button>

                    <button class="layui-btn layui-btn-radius layui-btn-primary" style="margin:0;width:80%;" id="set-password">

                        设置密码</button>

                </div>

            </div>

            

        </div>

        <div class="home-page-right" style="display: grid;grid-gap: 10px;grid-template-rows:55% auto;background-color: transparent;">

            <div class=" info-layout" style="min-height:2rem ;">

                <div class="layout-title-text"  style="font-size: 1rem;line-height: 3rem;font-weight: bold;">
					<img src="../images/xxlj/tongji.png" alt="" srcset="" style="height:1.2rem;width:1.2rem; padding: 0.2rem;">
					数据统计 
				</div>

                <div  style="display: grid;box-sizing: border-box;grid-template-columns:20% 19% 19% 19% 19%;grid-gap:10px;height:calc(100% - 4rem)">

                    

                    <div style="font-size:1rem;background-color:rgb(212 240 250);border-radius: 10px;padding: 5px;height: 100%;text-align: center;display: flex;flex-direction: row;align-items: center;justify-content: center;">

                        <div style="padding: 5px;">

                            <img src="../images/xxlj/daibanicon/daiban.png" alt="" srcset="" style="height:60px;width: 60px;">

                        </div>
                        <div>
                            <div style="font-size: 1rem;line-height: 2rem;" id="todo_cnt">待处理：0</div>
                            <div style="font-size: 1rem;line-height: 2rem;" id="mine_pro_cnt">已处理：0</div>

                        </div>
                    </div>

                    <div style="font-size:1rem;background-color: #ffffff;border-radius: 10px;padding:5px 20px ;height:100%;text-align: center;display: flex;flex-direction: column;align-items: flex-start;justify-content: center;">

                        <div style="font-size: 1rem;line-height: 2rem;">资源下载</div>

                        <div>
							<img src="../images/xxlj/daibanicon/xiazai.png" alt="" srcset="" style="height:1.2rem;width: 1.2rem;">

                            <span style="font-size: 1.2rem;" id="cn_con">0</span>
                        </div>

                    </div>
					<div style="font-size:1rem;background-color: #ffffff;border-radius: 10px;padding:5px 20px ;height:100%;text-align: center;display: flex;flex-direction: column;align-items: flex-start;justify-content: center;">

                        <div style="font-size: 1rem;line-height: 2rem;">基地数量</div>

                        <div>
							<img src="../images/xxlj/daibanicon/jidi.png" alt="" srcset="" style="height:1.2rem;width: 1.2rem;">

                            <span style="font-size: 1.2rem;" id="cn_con_jidi">0</span>
                        </div>

                    </div>
					<div style="font-size:1rem;background-color: #ffffff;border-radius: 10px;padding:5px 20px ;height:100%;text-align: center;display: flex;flex-direction: column;align-items: flex-start;justify-content: center;">

                        <div style="font-size: 1rem;line-height: 2rem;">学校数量</div>

                        <div>
							<img src="../images/xxlj/daibanicon/xuexiao.png" alt="" srcset="" style="height:1.2rem;width: 1.2rem;">

                            <span style="font-size: 1.2rem;" id="cn_con_xuexiao">0</span>
                        </div>

                    </div>
					<div style="font-size:1rem;background-color: #ffffff;border-radius: 10px;padding:5px 20px ;height:100%;text-align: center;display: flex;flex-direction: column;align-items: flex-start;justify-content: center;">

                        <div style="font-size: 1rem;line-height: 2rem;">已审批</div>

                        <div>
							<img src="../images/xxlj/daibanicon/yishen.png" alt="" srcset="" style="height:1.2rem;width: 1.2rem;">

                            <span style="font-size: 1.2rem;" id="mine_pro">0</span>
                        </div>

                    </div>
                </div>

            </div>

            <div class="info-layout" style="background-color: #ffffff;">

                <div class="layout-title-text"  style="font-size: 1rem;line-height: 1.6rem;font-weight: bold;">

                    <img src="../images/xxlj/changyong.png" alt="" srcset="" style="height:1.2rem;width:1.2rem; padding: 0.2rem;">常用功能</div>

                <div id="sys-apps" style="display: grid;grid-gap:5px;grid-template-columns: repeat(5, 6rem);padding: 10px;min-height:5rem;">
					<div>暂无常用功能</div>
                    <!-- <div style="padding: 5px;line-height: 1.2;height: calc(100% - 0);display: flex;align-items: center;flex-direction: column;justify-content: center;">

                        <img src="../images/appicon/caiwu.png" alt="" srcset="" style="">

                        <span style="font-size: 0.8rem;line-height:2.5rem;color: #000;">督导检查</span>

                    </div>
					<div style="padding: 5px;line-height: 1.2;height: calc(100% - 0);display: flex;align-items: center;flex-direction: column;justify-content: center;">

                        <img src="../images/appicon/caiwu.png" alt="" srcset="" style="">

                        <span style="font-size: 0.8rem;line-height:2.5rem;color: #000;">基地申请</span>

                    </div>
					<div style="padding: 5px;line-height: 1.2;height: calc(100% - 0);display: flex;align-items: center;flex-direction: column;justify-content: center;">

                        <img src="../images/appicon/caiwu.png" alt="" srcset="" style="">

                        <span style="font-size: 0.8rem;line-height:2.5rem;color: #000;">科研成果资料</span>

                    </div>
					<div style="padding: 5px;line-height: 1.2;height: calc(100% - 0);display: flex;align-items: center;flex-direction: column;justify-content: center;">

                        <img src="../images/appicon/caiwu.png" alt="" srcset="" style="">

                        <span style="font-size: 0.8rem;line-height:2.5rem;color: #000;">经费申请</span>

                    </div>
					<div style="padding: 5px;line-height: 1.2;height: calc(100% - 0);display: flex;align-items: center;flex-direction: column;justify-content: center;">

                        <img src="../images/appicon/caiwu.png" alt="" srcset="" style="">

                        <span style="font-size: 0.8rem;line-height:2.5rem;color: #000;">政策发布</span>

                    </div> -->

                </div>

            </div>

        </div>

        

    </div>

    <div class="layui-container" style="display: grid;grid-gap: 10px;grid-template-columns: 280px auto;height:44%;margin-top:10px; ">

        <div class="home-page-left" style="width:280px;display: grid;grid-gap: 10px;">

            <div class="user-info info-layout" style="background-image: url('../images/xxlj/tzbg.jpg');">

                <div class="layout-title-text"  style="font-size: 1rem;line-height: 1.6rem;font-weight: bold;border-bottom: 2px solid #ff441e;">申报须知</div>

                <div  style="display: flex;flex-direction: column; box-sizing: border-box; align-items:center;width: 100%;padding: 10px;">

                    <div>

                        layui 是一套开源的 Web UI 解决方案,其内部采用的是自身经典的模块化规范,并遵循原生 HTML/CSS/JS 的开发方式,极易上手,拿来即用。其外在极简,却又不失饱满的内在,体积轻盈,...layui 是一套开源的 Web UI 解决方案,其内部采用的是自身经典的模块化规范,并遵循原生 HTML/CSS/JS 的开发方式,极易上手,拿来即用。其外在极简,却又不失饱满的内在,体积轻盈,...layui 是一套开源的 Web UI 解决方案,其内部采用的是自身经典的模块化规范,并遵循原生 HTML/CSS/JS 的开发方式,极易上手,拿来即用。其外在极简,却又不失饱满的内在,体积轻盈,...

                    </div>

                    

                </div>

                <div  style="display: flex;flex-direction: column;justify-content: space-around; box-sizing: border-box; align-items:center;width: 100%;padding: 10px;">

                    <button class="layui-btn layui-btn-primary layui-border-blue layui-btn-radius" style="width:80%;">

                    查看详情</button>

                </div>

            </div>

            

        </div>

        

        <div class="home-page-right" style="display: grid;grid-gap: 10px;grid-template-columns: 60% auto;">
            <div class=" info-layout" style="background-color: #ffffff;">

                <div class="layout-title-text"  style="font-size: 1rem;line-height: 1.6rem;font-weight: bold;display: flex;justify-content: space-between;">
					<span>
						<img src="../images/appicon/caiwu.png" alt="" srcset="" style="height:1.2rem;width:1.2rem; padding: 0.2rem;">
						任务列表
					</span>
					<a style="color:#b0b1b1;">
						
						更多
						<i class="fa fa-database fa-1x" ></i>
					</a>
				</div>
                <div  style="box-sizing: border-box;width: 100%;padding: 10px;">
                    <table class="table" style="width: 100%;text-align: left;">

                        <tr class="table-hander" style="background-color: rgb(207, 240, 252);padding:5px;">

                            <th style="width:8rem ;">任务名称</th>

                            <th>内容</th>

                            <th>状态</th>

                            <th>负责人</th>

                            <th>日期</th>

                            <th>操作</th>

                        </tr>

                        <tr>

                            <td>测试名称测试名称</td>

                            <td>测试名称测试名称</td>

                            <td>待处理</td>

                            <td>姓名测试</td>

                            <td>2023-10-30</td>

                            <td>

                                按钮

                            </td>

                        </tr>

                        

                    </table>

                </div>

            </div>

            <div class=" info-layout" style="background-color: #ffffff;">

                <div class="layout-title-text"  style="font-size: 1rem;line-height: 1.6rem;font-weight: bold;"><img src="../images/appicon/caiwu.png" alt="" srcset="" style="height:1.2rem;width:1.2rem; padding: 0.2rem;">问题追踪记录</div>

                <div  style="box-sizing: border-box;width: 100%;padding: 10px;">

                    

                    <table class="table" style="width: 100%;text-align: left;">

                        <!-- <tr class="table-hander" style="background-color: rgb(239, 242, 252);">

                            <th style="width:8rem ;">任务名称</th>

                            <th>内容</th>

                            <th>状态</th>

                            <th>负责人</th>

                            <th>日期</th>

                            <th>操作</th>

                        </tr> -->

                        <tr>

                            <td style="color:#1e9fff;font-weight: bold;">2023-10-30</td>

                            <td>内容内容内容内容内容</td>

                        </tr>

                        <tr>

                            <td style="color:#1e9fff;font-weight: bold;">2023-10-30</td>

                            <td>内容内容内容内容内容</td>

                        </tr>

                        <tr>

                            <td style="color:#1e9fff;font-weight: bold;">2023-10-30</td>

                            <td>内容内容内容内容内容</td>

                        </tr>

                        <tr>

                            <td style="color:#1e9fff;font-weight: bold;">2023-10-30</td>

                            <td>内容内容内容内容内容</td>

                        </tr>

                        <tr>

                            <td style="color:#1e9fff;font-weight: bold;">2023-10-30</td>

                            <td>内容内容内容内容内容</td>

                        </tr>

                        <tr>

                            <td style="color:#1e9fff;font-weight: bold;">2023-10-30</td>

                            <td>内容内容内容内容内容</td>

                        </tr>

                        <tr>

                            <td style="color:#1e9fff;font-weight: bold;">2023-10-30</td>

                            <td>内容内容内容内容内容</td>

                        </tr>

                        <tr>

                            <td style="color:#1e9fff;font-weight: bold;">2023-10-30</td>

                            <td>内容内容内容内容内容</td>

                        </tr>

                        

                    </table>

                </div>

            </div>

        </div>

        

    </div>
	
	
	
	<script src="/js/jquery-3.7.1.min.js"></script>
	<script src="/js/jquery-migrate-3.4.1.min.js"></script>
	<script type="text/javascript" src="../layui/layui.js"></script>
	<script type="text/javascript" src="../../js/server.js"></script>
	<script type="text/javascript" src="../../js/server_common.js"></script>
	<script type="text/javascript" src="../js/index.js"></script>
	<!-- <script type="text/javascript" src="./user/user.js"></script> -->
<script>
(function () {

	let useApps = [
		{
			text:'督导检查',
			icon:'../images/xxlj/zhengfu/dudao.png',
			url:'/vpages/index.html#/list/srvledu_estimate_record_select',
			app:'ledu'
		},{
			text:'基地申请',
			icon:'../images/xxlj/zhengfu/jidi.png',
			url:'/vpages/index.html#/list/srvyxjdsb_apply_init_record_select',
			app:'ledu'
		},{
			text:'科研成果资料',
			icon:'../images/xxlj/zhengfu/keyan.png',
			url:'/vpages/index.html#/list/srvledu_research_support_select',
			app:'ledu'
		},{
			text:'经费申请',
			icon:'../images/xxlj/zhengfu/dudao.png',
			url:'/vpages/index.html#/list/srvledu_grant_apply_select',
			app:'ledu'
		},{
			text:'政策发布',
			icon:'../images/xxlj/zhengfu/zhengce.png',
			url:'/vpages/index.html#/list/srvyxjdsb_apply_notice_select',
			app:'ledu'
		}
	]


   // 个人信息
	let userInfo = window.sessionStorage.getItem('current_login_user') ? JSON.parse(window.sessionStorage.getItem('current_login_user')) : {}
	document.getElementById("user-name").innerText  = `姓名：${userInfo.real_name}`
	document.getElementById("user-no").innerText  = `工号：${userInfo.user_no}`
	let deptInfo = null 

	// if(userInfo.hasOwnProperty('_dept_info') && userInfo['_dept_info'] && userInfo['_dept_info'].dept_name){
	// 	document.getElementById("dept-name").innerText  = `所属机构：${userInfo['_dept_info'].dept_name}`
	// }else{
	// 	document.getElementById("dept-name").innerText  = `所属机构：无`
	// }
	
	
	
	// 获取菜单app
	// this.targetTenantFun = function(e){
	// 	let item = JSON.parse(e.dataset.options)
	// 	console.log(item)
	// 	goTenant(item)
	// }
    // var menus = JSON.parse(window.sessionStorage.getItem("current_login_user")) ;// 用户租户列表
    // var apps = JSON.parse(window.sessionStorage.getItem("sys_apps")) ;// 用户app列表
    // var avtiveTenant = JSON.parse(window.sessionStorage.getItem("current_login_user")).tenant ;// 当前租户
    // var userType = JSON.parse(window.sessionStorage.getItem("current_login_user")).user_type || '--' ;// 当前用户
	// menus = menus.hasOwnProperty('otherTenantInfos') ? menus.otherTenantInfos : []
	
 
	this.pendingList = function(){
		// 查询待办事项
		var elementArray = [];
		let app = 'ledu' 
		let bxReq = {
			"serviceName": "srvprocess_todo_cnt_select",
			"colNames": ["*"]
		}
		let resList = []
		var path = top.pathConfig.gateway + "/ledu/select/srvprocess_todo_cnt_select";
		let listElement = []	
		var callBack = function(res) {
			if (res.state == "SUCCESS") {
				resList = res.data
				if (Array.isArray(resList)  && resList.length > 0) {
					let data = resList[0]
					console.log(data)
					document.getElementById("todo_cnt").innerText = `待处理：${data['todo_cnt']}`;
					document.getElementById("mine_pro_cnt").innerText = `已处理：${data['mine_pro_cnt']}`;
					document.getElementById("mine_pro").innerText = `${data['mine_pro_cnt']}`;  // 已审批
				}
			}
		}
		crosAjax(path, "POST", bxReq, callBack);
	}
	this.downloadList = function(){
		// 资料下载统计
		var elementArray = [];
		let app = 'ledu' 
		let bxReq = {
			"serviceName": "srvledu_tchr_train_con_select",
			"colNames": ["*"],
			// "group":[{
			// 	colName:"cn_con",
			// 	type:"count"
			// }]
		}
		
		let resList = []
		var path = top.pathConfig.gateway + "/ledu/select/srvledu_tchr_train_con_select";
		
		let listElement = []	
		var callBack = function(res) {
			if (res.state == "SUCCESS") {
				resList = res.data
				
				if (Array.isArray(resList)  && resList.length > 0) {
					let data = resList[0]
					
					console.log(data)
					document.getElementById("cn_con").innerText = `${data['cn_con'] ? data['cn_con']: 0}`;	
				}
			}
		}
		crosAjax(path, "POST", bxReq, callBack);
	}
	this.taskList = function(){
		// 任务列表
		var elementArray = [];
		let app = 'ledu' 
		let bxReq = {
			"serviceName": "srvprocess_todo_select",
			"colNames": ["*"]
		}
		
		let resList = []
		var path = top.pathConfig.gateway + "/ledu/select/srvprocess_todo_select";
		
		let listElement = []	
		var callBack = function(res) {
			if (res.state == "SUCCESS") {
				resList = res.data
				
				if (Array.isArray(resList)  && resList.length > 0) {
					let data = resList
					
					console.log(data)
					// document.getElementById("cn_con").innerText = `${data['cn_con'] ? data['cn_con']: 0}`;	
				}
			}
		}
		crosAjax(path, "POST", bxReq, callBack);
	}
	this.msgList = function(){
		// 公告列表
		var elementArray = [];
		let app = 'ledu' 
		let bxReq = {
			"serviceName": "bxledu_issue_track",
			"colNames": ["*"]
		}
		
		let resList = []
		var path = top.pathConfig.gateway + "/ledu/select/bxledu_issue_track";
		
		let listElement = []	
		var callBack = function(res) {
			if (res.state == "SUCCESS") {
				resList = res.data
				
				if (Array.isArray(resList)  && resList.length > 0) {
					let data = resList
					
					console.log(data)
					// document.getElementById("cn_con").innerText = `${data['cn_con'] ? data['cn_con']: 0}`;	
				}
			}
		}
		crosAjax(path, "POST", bxReq, callBack);
	}

	this.reloadApps = function(){
		let elementArray = []
		if(Array.isArray(useApps) && useApps.length > 0){
			for(let i=0;i<useApps.length; i++){
				let app = useApps[i]
				let str = `<a class="use-app" url="${app.url}" app="${app.app}" style="padding: 5px;line-height: 1.2;height: calc(100% - 0);display: flex;align-items: center;flex-direction: column;justify-content: center;cursor: pointer;">

							<img src="${app.icon}" alt="" srcset="" style="width:40px;height:40px;">

							<span style="font-size: 0.8rem;line-height:2.5rem;color: #000;">${app.text}</span>

							</a>`
				
				
				elementArray.push(str)
			}
		}
		
		document.getElementById("sys-apps").innerHTML = elementArray.join('')
	}

	$("body").on("click", "#set-password  ", function () {
		// 设置密码
		let page = {
			app:null,
			title: '修改密码',
			url: 'page/user/changePwd.html',
			icon: ''
		}
		top.tab.addTab(page);
	})
	$("body").on("click", "a.use-app  ", function () {
		// 点击常用功能打开页面
		let href = $(this).attr('url');
		let app = $(this).attr('app');
		console.log($(this),href,$(this).attr('app'))
		let page = {
			app:app,
			title: $(this).context.outerText,
			url: href,
			icon: ''
		}
		top.tab.addTab(page);
		// addTab($(this));
	})
	


	this.pendingList() // 查询待办
	this.downloadList() // 资料下载
	this.taskList() // 任务列表
	this.msgList() // 问题追踪
	this.reloadApps() // 常用应用
	
    
})()
</script>
	
</body>
</html>